<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>SkyReserve</title>
  <link href='https://unpkg.com/boxicons@2.1.4/css/boxicons.min.css' rel='stylesheet'>
  <link rel="stylesheet" href="styles.css">
  <link rel="stylesheet" href="footer.css">

  <link rel="stylesheet" href="https://unpkg.com/aos@next/dist/aos.css" />

  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/flatpickr/dist/flatpickr.min.css">
</head>

<body>
  <!-- Header Section -->
  <header data-aos="fade-down" data-aos-duration="3000">
    <!-- Logo Section -->
    <h1 class="logo">SKYRESERVE</h1>
    <nav>
      <ul class="nav_links">
        <li><a href="TI/TI.html">Travel Info</a></li>
        <li><a href="About/About.html">About</a></li>
        <li><a href="login.html">Log In</a></li>
      </ul>
    </nav>
    <div class="menu-icon" id="menuIcon">
      <i class='bx bx-menu'></i>
    </div>
  </header>

  <!-- Main Section -->
  <main class="main-container">
    <section class="left-section" data-aos="fade-right" data-aos-duration="3000">
      <div class="content">
        <!-- Title Section -->
        <h1>From screen to sky,<br> effortlessly yours.</h1>
        <!-- Form Section -->
        <form id="bookingForm">

          <!-- Trip Section -->
          <div class="trip-type-wrapper">
            <div class="custom-select">
              <select name="trips" id="trips" required>
                <option value="" disabled selected>Select your trip</option>
                <option value="round-trip">Round-trip</option>
              </select>
              <i class='bx bx-chevron-down'></i>
            </div>
          </div>

          <div class="input-group">
                  <!-- Departure Section -->
                  <div class="input-wrapper">
                      <label for="takeOff" class="input-label">From</label>
                      <select id="takeOff" required>
                          <option value="" disabled selected>Select Departure</option>
                          <option value="Philippines">Philippines</option>
                          <option value="Japan">Japan</option>
                          <option value="France">France</option>
                          <option value="China">China</option>
                          <option value="United States">United States</option>
                      </select>
                  </div>

                  <div class="icon">
                      <i class='bx bxs-plane-alt'></i>
                  </div>

                  <!-- Destination Section -->
                  <div class="input-wrapper">
                      <label for="arrival" class="input-label">To</label>
                      <select id="arrival" required>
                          <option value="" disabled selected>Select Destination</option>
                          <option value="Philippines">Philippines</option>
                          <option value="Japan">Japan</option>
                          <option value="France">France</option>
                          <option value="China">China</option>
                          <option value="United States">United States</option>
                      </select>
                  </div>
              </div>

          <div class="input-group">
            <!-- Departure Date Section -->
            <div class="input-wrapper">
              <label for="departureDate" class="input-label">Depart</label>
              <input type="text" id="departureDate" name="date" placeholder="Depart" required>
            </div>

            <div class="icon">
              <i class='bx bxs-calendar'></i>
            </div>

            <!-- Return Date Section -->
            <div class="input-wrapper">
              <label for="returnDate" class="input-label">Return</label>
              <input type="text" id="returnDate" name="date" placeholder="Returning on" required>
            </div>
          </div>

          <!-- Button Section -->
          <button type="submit">Search flights</button>
        </form>
      </div>

      <!-- Slider Section -->
      <div class="slider">
        <div class="slider-header">
          <h2>Popular Destination</h2>
          <div class="slider-buttons">
            <button id="prev" class="slider-btn">
              <i class='bx bx-chevron-left'></i>
            </button>

            <button id="next" class="slider-btn">
              <i class='bx bx-chevron-right'></i>
            </button>
          </div>
        </div>

        <div class="slider-container">
          <div class="slider-images">

            <div class="slide">
              <img src="Images/china.jpg" alt="China">
              <div class="info">
                <p class="location">Beijing, China</p>
                <p class="sub-location">The Great Wall Adventure</p>
                <div class="price">
                  <span class="slide-icon"><i class='bx bxs-plane-take-off'></i></span>
                  <span>$430</span>
                </div>
              </div>
            </div>

            <div class="slide">
              <img src="Images/cyprus.jpg" alt="Cyprus">
              <div class="info">
                <p class="location">Paphos, Cyprus</p>
                <p class="sub-location">Mediterranean Getaway</p>
                <div class="price">
                  <span class="slide-icon"><i class='bx bxs-plane-take-off'></i></span>
                  <span>$520</span>
                </div>
              </div>
            </div>

            <div class="slide">
              <img src="Images/japan.jpg" alt="Japan">
              <div class="info">
                <p class="location">Tokyo, Japan</p>
                <p class="sub-location">Cherry Blossoms & Culture</p>
                <div class="price">
                  <span class="slide-icon"><i class='bx bxs-plane-take-off'></i></span>
                  <span>$480</span>
                </div>
              </div>
            </div>

            <div class="slide">
              <img src="Images/paris.jpg" alt="Paris">
              <div class="info">
                <p class="location">Paris, France</p>
                <p class="sub-location">City of Lights</p>
                <div class="price">
                  <span class="slide-icon"><i class='bx bxs-plane-take-off'></i></span>
                  <span>$610</span>
                </div>
              </div>
            </div>

            <div class="slide">
              <img src="Images/s.korea.jpg" alt="South Korea">
              <div class="info">
                <p class="location">Seoul, South Korea</p>
                <p class="sub-location">Tech & Tradition</p>
                <div class="price">
                  <span class="slide-icon"><i class='bx bxs-plane-take-off'></i></span>
                  <span>$450</span>
                </div>
              </div>
            </div>

            <div class="slide">
              <img src="Images/spain.jpg" alt="Spain">
              <div class="info">
                <p class="location">Barcelona, Spain</p>
                <p class="sub-location">Beach & Gothic Charm</p>
                <div class="price">
                  <span class="slide-icon"><i class='bx bxs-plane-take-off'></i></span>
                  <span>$560</span>
                </div>
              </div>
            </div>

          </div>
        </div>
      </div>
    </section>
  </main>

  <!-- Footer Section -->
  <div id="footer-placeholder"></div>

  <script type="text/javascript" src="script.js"></script>
  <script src="https://unpkg.com/aos@next/dist/aos.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/flatpickr"></script>

  <script>
    // To animate
    AOS.init({ offset: 1 });

    document.addEventListener("DOMContentLoaded", () => {
        const today = new Date();

        // Initialize departure date picker (dual-calendar but single selection display)
        const departurePicker = flatpickr("#departureDate", {
            dateFormat: "d M Y",
            defaultDate: today,
            minDate: today,
            showMonths: 2, // Displays May & June side by side
            mode: "range", // Enables range selection but modifies input display
            onOpen: function (selectedDates, dateStr, instance) {
                try {
                    const calendarContainer = instance.calendarContainer;
                    if (calendarContainer) {
                        calendarContainer.classList.add("dual-calendar"); // Styling only for departure picker
                    }
                } catch (error) {
                    console.warn("Flatpickr styling error:", error);
                }
            },
            onChange: function (selectedDates) {
                if (selectedDates.length > 0) {
                    const departDate = selectedDates[0];

                    // Ensure return date starts in June while staying empty initially
                    returnPicker.set("minDate", departDate);

                    // Show only departure date in input (not full range)
                    departurePicker.input.value = flatpickr.formatDate(departDate, "d M Y");

                    // Update the return field ONLY when both dates are selected
                    if (selectedDates.length === 2) {
                        document.getElementById("returnDate").value = flatpickr.formatDate(selectedDates[1], "d M Y");
                    } else {
                        document.getElementById("returnDate").value = "";
                    }
                }
            }
        });

        // Initialize return date input (neutral, waits for user selection)
        const returnPicker = flatpickr("#returnDate", {
            dateFormat: "d M Y",
            minDate: today, // Updates dynamically but stays independent
            defaultDate: null, // Keeps field empty until user selects
        });
    });

document.addEventListener("DOMContentLoaded", () => {
    console.log("üîç Initializing flight search...");
    setupLoadingAnimation();
});

// üîÑ Setup Loading Animation Once
function setupLoadingAnimation() {
    const loadingOverlay = document.createElement("div");
    loadingOverlay.id = "loadingOverlay";
    loadingOverlay.style.display = "none";
    loadingOverlay.innerHTML = "<p>üîÑ Searching for flights...</p>";
    document.body.appendChild(loadingOverlay);
}

function showLoading() {
    document.getElementById("loadingOverlay").style.display = "block";
}

function hideLoading() {
    document.getElementById("loadingOverlay").style.display = "none";
}

      document.getElementById("bookingForm").addEventListener("submit", function(event) {
          event.preventDefault(); // Prevent actual submission

          // Save values to LocalStorage
          localStorage.setItem("from", document.getElementById("takeOff").value);
          localStorage.setItem("to", document.getElementById("arrival").value);
          localStorage.setItem("departureDate", document.getElementById("departureDate").value);
          localStorage.setItem("returnDate", document.getElementById("returnDate").value);

          // Redirect to confirmation page
          window.location.href = "confirmation.html";
      });

      // To proceed to the hidden html
      function proceedToNextPage() {
          console.log("‚úÖ Redirecting to confirmation page...");
          window.location.href = "confirmation.html";
      }

        // To detect user location
        function detectUserLocation() {
            if (navigator.geolocation) {
                navigator.geolocation.getCurrentPosition(successCallback, errorCallback);
            } else {
                console.error("‚ùå Geolocation is not supported.");
                setDefaultDeparture();
            }
        }

        function successCallback(position) {
            const latitude = position.coords.latitude;
            const longitude = position.coords.longitude;
            console.log(`üìç User Location: ${latitude}, ${longitude}`);

            // üîÑ Instead of fetching from OpenStreetMap, set a default country manually
            document.getElementById("takeOff").value = "Philippines"; // You can set a different default if needed
        }

        function errorCallback(error) {
            console.error("‚ùå Geolocation Error:", error.message);
            setDefaultDeparture();
        }

        function setDefaultDeparture() {
            document.getElementById("takeOff").value = "Philippines"; // Fallback location
        }

        // Call this function inside `DOMContentLoaded`
        document.addEventListener("DOMContentLoaded", detectUserLocation);

      fetch("Footer/footer.html")
        .then(response => response.text())
        .then(data => {
          document.getElementById("footer-placeholder").innerHTML = data;
        });
  </script>
</body>
</html>